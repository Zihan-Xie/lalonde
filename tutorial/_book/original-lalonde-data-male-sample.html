<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Original LaLonde Data (Male Sample) | Tutorial and Code for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’</title>
<meta name="author" content="Guido Imbens, Yiqing Xu">
<meta name="description" content="In this section, we will focus on the original LaLonde data set (loaded as NSW below) to assess the effect of the treatment (participation in the job training program) on the participants’...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="3 Original LaLonde Data (Male Sample) | Tutorial and Code for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’">
<meta property="og:type" content="book">
<meta property="og:description" content="In this section, we will focus on the original LaLonde data set (loaded as NSW below) to assess the effect of the treatment (participation in the job training program) on the participants’...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Original LaLonde Data (Male Sample) | Tutorial and Code for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’">
<meta name="twitter:description" content="In this section, we will focus on the original LaLonde data set (loaded as NSW below) to assess the effect of the treatment (participation in the job training program) on the participants’...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tutorial and Code for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started</a></li>
<li><a class="" href="lalonde-dehejia-wahba-ldw-data.html"><span class="header-section-number">2</span> LaLonde-Dehejia-Wahba (LDW) Data</a></li>
<li><a class="active" href="original-lalonde-data-male-sample.html"><span class="header-section-number">3</span> Original LaLonde Data (Male Sample)</a></li>
<li><a class="" href="the-lottery-data.html"><span class="header-section-number">4</span> The Lottery Data</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/xuyiqing/lalonde">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="original-lalonde-data-male-sample" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Original LaLonde Data (Male Sample)<a class="anchor" aria-label="anchor" href="#original-lalonde-data-male-sample"><i class="fas fa-link"></i></a>
</h1>
<p>In this section, we will focus on the original LaLonde data set (loaded as NSW below) to assess the effect of the treatment (participation in the job training program) on the participants’ earnings in 1978.</p>
<div id="prepare-the-data" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Prepare the Data<a class="anchor" aria-label="anchor" href="#prepare-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>First, the dataset is split into treatment and control groups by the treatment dummy. Note, two pretreatment variables (earnings in 1974 and employment status in 1974) are absent from this sample. We thus remove variables re74 (earnings in 1974), u74 (unemployment status in 1974), and tau (the treatment effect estimate) from the CPS-1 and PSID-1 datasets to match the structure of the treatment dataset.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/lalonde.RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/trimmed.RData"</span><span class="op">)</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">nsw_co</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># drop re74, u74, tau from cps1 and psid1</span></span>
<span><span class="va">cps1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">cps1</span>, select <span class="op">=</span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">re74</span>, <span class="va">u74</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_cps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">nsw_tr</span>, <span class="va">cps1a</span><span class="op">)</span></span>
<span></span>
<span><span class="va">psid1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">psid1</span>, select <span class="op">=</span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">re74</span>, <span class="va">u74</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_psid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">nsw_tr</span>, <span class="va">psid1a</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">nsw_cps.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">nsw_cps</span>, <span class="va">nsw_co</span><span class="op">)</span></span>
<span><span class="va">nsw_psid.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">nsw_psid</span>, <span class="va">nsw_co</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="assessing-overlap-1" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Assessing Overlap<a class="anchor" aria-label="anchor" href="#assessing-overlap-1"><i class="fas fa-link"></i></a>
</h2>
<p>In this step, we define variables for the outcome (Y = “re78”), treatment indicator (treat), and covariates that include age, education, race/ethnicity indicators, marital status, degree status, and earnings in 1975.</p>
<p>Again, we assess overlap in covariate distributions between treated and control groups based on the propensity score via GRF (log odds ratio) for the LDW-Experimental, LDW-CPS1, and LWD-PSID1 data.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define variables</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"re78"</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"black"</span>, <span class="st">"hispanic"</span>, <span class="st">"married"</span>, <span class="st">"nodegree"</span>, <span class="st">"re75"</span>, <span class="st">"u75"</span><span class="op">)</span></span></code></pre></div>
<div id="nsw-experimental" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> NSW-Experimental<a class="anchor" aria-label="anchor" href="#nsw-experimental"><i class="fas fa-link"></i></a>
</h3>
<p>Figure: Experimental (male sample).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsw_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-35-1.png" alt="FIGUREA5 (SM). SubfigureA:LDW-Experimental." width="80%"><p class="caption">
Figure 3.1: FIGUREA5 (SM). SubfigureA:LDW-Experimental.
</p>
</div>
</div>
<div id="nsw-cps1-and-nsw-psid1" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> NSW-CPS1 and NSW-PSID1<a class="anchor" aria-label="anchor" href="#nsw-cps1-and-nsw-psid1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_cps_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_cps</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_psid_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_psid</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-36-1.png" alt="FIGUREA5 (SM). SubfigureB:NSW-CPS1. SubfigureC:NSW-PSID1." width="100%"><p class="caption">
Figure 3.2: FIGUREA5 (SM). SubfigureB:NSW-CPS1. SubfigureC:NSW-PSID1.
</p>
</div>
</div>
</div>
<div id="trimming-to-improve-overlap-1" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Trimming to Improve Overlap<a class="anchor" aria-label="anchor" href="#trimming-to-improve-overlap-1"><i class="fas fa-link"></i></a>
</h2>
<p>We then trim the data to improve overlap in covariate distributions by removing units with poor overlap based on the propensity score. This step aims to refine the datasets to improve later causal inference. With the trimmed data, we can reassess overlap for each group.</p>
<p>Like before, we start by assessing overlaps between the distributions of the treated and control groups based on log-odds derived from propensity scores.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsw_cps.plus_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_cps.plus</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_psid.plus_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_psid.plus</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, we proceed with trimming to improve the quality of the causal inference. After trimming, we would expect the distributions to align more closely - the treatment and control groups are more comparable according to their covariates.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Trim</span></span>
<span><span class="va">nsw_cps_trim</span> <span class="op">&lt;-</span> <span class="fu">trim</span><span class="op">(</span><span class="va">nsw_cps.plus_ps</span>, threshold <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="va">nsw_psid_trim</span> <span class="op">&lt;-</span> <span class="fu">trim</span><span class="op">(</span><span class="va">nsw_psid.plus_ps</span>, threshold <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cps data</span></span>
<span><span class="co"># excluding the experimental controls</span></span>
<span><span class="va">nsw_cps_trim_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nsw_cps_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span><span class="op">)</span></span>
<span><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span><span class="va">nsw_cps_trim_match</span> <span class="op">&lt;-</span> <span class="fu">psmatch</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_cps_trim_match</span>, Y <span class="op">=</span> <span class="st">"re78"</span>, treat <span class="op">=</span> <span class="st">"treat"</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psid data</span></span>
<span><span class="co"># excluding the experimental controls</span></span>
<span><span class="va">nsw_psid_trim_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nsw_psid_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span><span class="op">)</span></span>
<span><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span><span class="va">nsw_psid_trim_match</span> <span class="op">&lt;-</span> <span class="fu">psmatch</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_psid_trim_match</span>, Y <span class="op">=</span> <span class="st">"re78"</span>, treat <span class="op">=</span> <span class="st">"treat"</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">threshold</span> <span class="op">=</span> <span class="fl">0.85</span></span>
<span><span class="co">#cps</span></span>
<span><span class="va">nsw_trim_cps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nsw_cps_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_trim_cps</span><span class="op">$</span><span class="va">treat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">nsw_trim_cps</span><span class="op">$</span><span class="va">sample</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co">#psid</span></span>
<span><span class="va">nsw_trim_psid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nsw_psid_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nsw_trim_psid</span><span class="op">$</span><span class="va">treat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">nsw_trim_psid</span><span class="op">$</span><span class="va">sample</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
</div>
<div id="reassessing-overlap-1" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Reassessing Overlap<a class="anchor" aria-label="anchor" href="#reassessing-overlap-1"><i class="fas fa-link"></i></a>
</h2>
<p>The propensity scores are reestimated after trimming.The plots below show good overlaps especially in the center, indicating an improved balance and common support between the treated and control groups. The before-after trimming comparison suggests that the trim effectively removes units that were less comparable.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># cps data</span></span>
<span><span class="va">nsw_cps_trim_match_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_cps_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psid data</span></span>
<span><span class="va">nsw_psid_trim_match_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">nsw_psid_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-40"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-40-1.png" alt="FIGUREA5 (SM). SubfigureD:TrimmedLDW-CPS1. SubfigureE:TrimmedLDW-PSID1." width="100%"><p class="caption">
Figure 3.3: FIGUREA5 (SM). SubfigureD:TrimmedLDW-CPS1. SubfigureE:TrimmedLDW-PSID1.
</p>
</div>
</div>
<div id="estimating-the-att-1" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Estimating the ATT<a class="anchor" aria-label="anchor" href="#estimating-the-att-1"><i class="fas fa-link"></i></a>
</h2>
<p>The table below presents the ATT estimates using the original LaLonde male sample, of which the LDW sample is a subset. Table shows that, with sufficient overlap, most estimators yield estimates within relatively narrow ranges when using either CPS-SSA-1 or PSID-1 as control groups. However, these estimates do not align with the experimental benchmarks, with most estimates being negative.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># experimental</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_trim_cps</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_trim_psid</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co"># nonexperimental</span></span>
<span><span class="va">out4</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_cps</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out5</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_psid</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out6</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_cps_trim_match</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out7</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">nsw_psid_trim_match</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the result</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">out4</span>, <span class="va">out5</span>, <span class="va">out6</span>, <span class="va">out7</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">n</span><span class="op">+</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NSW-CPS1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"NSW-PSID1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"NSW-CPS1 (PS Trimmed) "</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"NSW-PSID1 (PS Trimmed)"</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental Benchmark"</span>, <span class="st">"Difference-in-Means"</span>, <span class="st">"Regression"</span>, <span class="st">" Oaxaca Blinder"</span>, <span class="st">"GRF"</span>, <span class="st">"NN Matching"</span>, <span class="st">"PS Matching"</span>, <span class="st">"IPW"</span>, <span class="st">"CBPS"</span>, <span class="st">"Entropy Balancing"</span>, <span class="st">"DML-ElasticNet"</span>, <span class="st">"AIPW-GRF"</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">TRUE</span>, caption <span class="op">=</span> <span class="st">" Table A4 in the Supplementary Materials (SM), ATT Estimates: LaLonde Male Sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-42">Table 3.1: </span> Table A4 in the Supplementary Materials (SM), ATT Estimates: LaLonde Male Sample</caption>
<colgroup>
<col width="17%">
<col width="6%">
<col width="6%">
<col width="2%">
<col width="7%">
<col width="7%">
<col width="2%">
<col width="17%">
<col width="6%">
<col width="2%">
<col width="17%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">NSW-CPS1</th>
<th align="left"></th>
<th align="left"></th>
<th align="left">NSW-PSID1</th>
<th align="left"></th>
<th align="left"></th>
<th align="left">NSW-CPS1 (PS Trimmed)</th>
<th align="left"></th>
<th align="left"></th>
<th align="left">NSW-PSID1 (PS Trimmed)</th>
<th align="left"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Experimental Benchmark</td>
<td align="left">886.30</td>
<td align="left">(488.14)</td>
<td align="left"></td>
<td align="left">886.30</td>
<td align="left">(488.14)</td>
<td align="left"></td>
<td align="left">806.06</td>
<td align="left">(488.59)</td>
<td align="left"></td>
<td align="left">620.04</td>
<td align="left">(667.69)</td>
</tr>
<tr class="even">
<td align="left">Difference-in-Means</td>
<td align="left">-8870.31</td>
<td align="left">(408.30)</td>
<td align="left"></td>
<td align="left">-15577.57</td>
<td align="left">(508.12)</td>
<td align="left"></td>
<td align="left">-235.15</td>
<td align="left">(564.20)</td>
<td align="left"></td>
<td align="left">-3805.68</td>
<td align="left">(1158.27)</td>
</tr>
<tr class="odd">
<td align="left">Regression</td>
<td align="left">-792.15</td>
<td align="left">(479.67)</td>
<td align="left"></td>
<td align="left">-1581.11</td>
<td align="left">(718.80)</td>
<td align="left"></td>
<td align="left">-188.50</td>
<td align="left">(546.17)</td>
<td align="left"></td>
<td align="left">-3805.87</td>
<td align="left">(1228.97)</td>
</tr>
<tr class="even">
<td align="left">Oaxaca Blinder</td>
<td align="left">-726.42</td>
<td align="left">(462.50)</td>
<td align="left"></td>
<td align="left">-1215.01</td>
<td align="left">(481.08)</td>
<td align="left"></td>
<td align="left">-168.78</td>
<td align="left">(437.15)</td>
<td align="left"></td>
<td align="left">-4029.24</td>
<td align="left">(640.17)</td>
</tr>
<tr class="odd">
<td align="left">GRF</td>
<td align="left">-973.23</td>
<td align="left">(450.96)</td>
<td align="left"></td>
<td align="left">-2827.30</td>
<td align="left">(454.87)</td>
<td align="left"></td>
<td align="left">12.87</td>
<td align="left">(422.40)</td>
<td align="left"></td>
<td align="left">-3713.34</td>
<td align="left">(527.73)</td>
</tr>
<tr class="even">
<td align="left">NN Matching</td>
<td align="left">-290.38</td>
<td align="left">(585.14)</td>
<td align="left"></td>
<td align="left">-1122.98</td>
<td align="left">(1210.25)</td>
<td align="left"></td>
<td align="left">36.05</td>
<td align="left">(631.36)</td>
<td align="left"></td>
<td align="left">-4793.26</td>
<td align="left">(1338.66)</td>
</tr>
<tr class="odd">
<td align="left">PS Matching</td>
<td align="left">-351.66</td>
<td align="left">(565.05)</td>
<td align="left"></td>
<td align="left">-4085.43</td>
<td align="left">(770.63)</td>
<td align="left"></td>
<td align="left">-235.15</td>
<td align="left">(571.57)</td>
<td align="left"></td>
<td align="left">-3805.68</td>
<td align="left">(1172.63)</td>
</tr>
<tr class="even">
<td align="left">IPW</td>
<td align="left">-531.26</td>
<td align="left">(485.39)</td>
<td align="left"></td>
<td align="left">-2018.84</td>
<td align="left">(986.56)</td>
<td align="left"></td>
<td align="left">30.31</td>
<td align="left">(556.20)</td>
<td align="left"></td>
<td align="left">-4346.24</td>
<td align="left">(1382.71)</td>
</tr>
<tr class="odd">
<td align="left">CBPS</td>
<td align="left">-566.41</td>
<td align="left">(476.37)</td>
<td align="left"></td>
<td align="left">-718.81</td>
<td align="left">(888.13)</td>
<td align="left"></td>
<td align="left">-136.08</td>
<td align="left">(570.57)</td>
<td align="left"></td>
<td align="left">-3870.47</td>
<td align="left">(1320.64)</td>
</tr>
<tr class="even">
<td align="left">Entropy Balancing</td>
<td align="left">-566.82</td>
<td align="left">(476.39)</td>
<td align="left"></td>
<td align="left">-691.85</td>
<td align="left">(889.21)</td>
<td align="left"></td>
<td align="left">-136.70</td>
<td align="left">(570.43)</td>
<td align="left"></td>
<td align="left">-3965.87</td>
<td align="left">(1339.89)</td>
</tr>
<tr class="odd">
<td align="left">DML-ElasticNet</td>
<td align="left">-787.03</td>
<td align="left">(479.32)</td>
<td align="left"></td>
<td align="left">-1673.83</td>
<td align="left">(722.32)</td>
<td align="left"></td>
<td align="left">-334.60</td>
<td align="left">(545.61)</td>
<td align="left"></td>
<td align="left">-3816.99</td>
<td align="left">(1216.93)</td>
</tr>
<tr class="even">
<td align="left">AIPW-GRF</td>
<td align="left">-344.27</td>
<td align="left">(515.40)</td>
<td align="left"></td>
<td align="left">-1859.96</td>
<td align="left">(878.55)</td>
<td align="left"></td>
<td align="left">183.94</td>
<td align="left">(548.04)</td>
<td align="left"></td>
<td align="left">-4247.06</td>
<td align="left">(1346.55)</td>
</tr>
</tbody>
</table></div>
<p>The table above lists the ATT estimates using different statistical methods to assess the impact of a treatment-job training program- on earnings in 1978 (re78). The results are shown for two control groups (CPS1 and PSID1) both before and after trimming based on propensity scores to improve the match between treated and control units. While the trimming generally moves the estimates closer to the experimental benchmark, estimates derived from observational data are generally lower (more negative) than the experimental benchmark.</p>
</div>
<div id="alternative-estimands-catt-and-qtet-1" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Alternative Estimands: CATT and QTET<a class="anchor" aria-label="anchor" href="#alternative-estimands-catt-and-qtet-1"><i class="fas fa-link"></i></a>
</h2>
<div id="conditional-average-treatment-effect-on-the-treated-catt-1" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> Conditional Average Treatment Effect on the Treated (CATT)<a class="anchor" aria-label="anchor" href="#conditional-average-treatment-effect-on-the-treated-catt-1"><i class="fas fa-link"></i></a>
</h3>
<p>The figures below show the CATT estimates using the original LaLonde data (male sample).</p>
<p>Each point on the scatter plots represents a pair of CATT estimates for a single unit: one from the experimental benchmark and one from the observational method. Points that lie on the 45-degree line (the red line) are cases where the observational and experimental methods yield the same estimate.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate catt</span></span>
<span><span class="va">catt.nsw</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.cps</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.psid</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.cps.trim</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_cps_trim_match</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.psid.trim</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_psid_trim_match</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co"># trimmed experimental data</span></span>
<span><span class="va">catt.nsw.cps</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_trim_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.nsw.psid</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">nsw_trim_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (CPS-Full)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.cps</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.cps</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (CPS-Full)"</span>,</span>
<span>          main <span class="op">=</span> <span class="st">"A. NSW-CPS1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (PSID-Full)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.psid</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.psid</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (PSID-Full)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"B. NSW-PSID1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (CPS-Trimmed)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw.cps</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw.cps</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.cps.trim</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.cps.trim</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (CPS-Trimmed)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"C. NSW-CPS1 Trimmed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (PSID-Trimmed)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw.psid</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.nsw.psid</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.psid.trim</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.psid.trim</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (PSID-Trimmed)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"D. NSW-PSID1 Trimmed"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-44-1.png" alt="FIGURE A6. CATT Estimates for the LaLonde Data (Male Sample)" width="100%"><p class="caption">
Figure 3.4: FIGURE A6. CATT Estimates for the LaLonde Data (Male Sample)
</p>
</div>
<p>Note: Scatterplots show the CATT using both experimental data (x-axis) and nonexperimental data (y-axis) from LaLonde (1986) (male sample). Each dot corresponds to a CATT estimate based on the covariate values of a treated unit, while each red cross symbolizes the ATT estimates. For every estimate, the AIPW estimator is employed, with the GRF approach for estimating nuisance parameters. Different subfigures indicate various data comparisons: Subfigure A: Compares Experimental with LaLonde-CPS1. Subfigure B: Compares Experimental with LaLonde-PSID1. Subfigure C: Compares trimmed Experimental (removing 30 treated units) against trimmed NSW-CPS1. Subfigure D: Compares trimmed Experimental (removing 150 treated units) to trimmed NSW-PSID1.</p>
<p>Based on untrimmed data, Subfigure A and B show a wide dispersion of points around the 45-degree line. This raises our concern about the lack of agreement between the experimental benchmark and the CATT estimates from the CPS1 and PSID1 control groups.</p>
<p>On the other hand, after trimming based on propensity scores, the dispersion of points in Subfigure C and D is more concentrated around the 45-degree line, indicating that the agreement between the experimental benchmark and the CATT estimates has improved. The comparison suggests that trimming has successfully reduced bias in estimating the treatment effect by ensuring that the treated and control groups are more similar in covariates distributions.</p>
</div>
<div id="quantile-treatment-effect-on-the-treated-qtet-1" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> Quantile Treatment Effect on the Treated (QTET)<a class="anchor" aria-label="anchor" href="#quantile-treatment-effect-on-the-treated-qtet-1"><i class="fas fa-link"></i></a>
</h3>
<p>The Figures below show the quantile treatment effects on the treated in the original LaLonde male sample. QTET analysis helps us to see where along the outcome distribution the treatment is more or less effective.
The code below consists of two main parts:</p>
<ul>
<li>The <code>est_qte</code> function estimates the QTET.</li>
<li>Plotting QTET: The <code>plot_qte</code> function creates the plots, with separate plots for each data comparison (NSW-CPS, NSW-CPS trimmed, NSW-PSID, and NSW-PSID trimmed).</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate qte (some of the following lines are not run due to computational limitation)</span></span>
<span><span class="va">qte.nsw</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">nsw</span><span class="op">)</span></span>
<span><span class="va">qte.nsw.cps</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">nsw_trim_cps</span><span class="op">)</span></span>
<span><span class="va">qte.nsw.psid</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">nsw_trim_psid</span><span class="op">)</span></span>
<span><span class="co">#qte.nsw_cps &lt;- est_qte(Y, treat, covar, data = nsw_cps) # adjusted</span></span>
<span><span class="co">#qte.nsw_cps0 &lt;- est_qte(Y, treat, NULL, data = nsw_cps) # unadjusted</span></span>
<span><span class="va">qte.nsw_cps.trim</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, data <span class="op">=</span> <span class="va">nsw_cps_trim_match</span><span class="op">)</span> <span class="co"># adjusted</span></span>
<span><span class="va">qte.nsw_cps.trim0</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">nsw_cps_trim_match</span><span class="op">)</span> <span class="co"># unadjusted</span></span>
<span><span class="co">#qte.nsw_psid &lt;- est_qte(Y, treat, covar, data = nsw_psid) # adjusted</span></span>
<span><span class="co">#qte.nsw_psid0 &lt;- est_qte(Y, treat, NULL, data = nsw_psid) # unadjusted</span></span>
<span><span class="va">qte.nsw_psid.trim</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, data <span class="op">=</span> <span class="va">nsw_psid_trim_match</span><span class="op">)</span> <span class="co"># adjusted</span></span>
<span><span class="va">qte.nsw_psid.trim0</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">nsw_psid_trim_match</span><span class="op">)</span> <span class="co"># unadjusted</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot qte</span></span>
<span></span>
<span><span class="co">#load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/qte_nsw.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># CPS</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.nsw_cps</span>, <span class="va">qte.nsw_cps0</span>, <span class="va">qte.nsw</span>, main <span class="op">=</span> <span class="st">"NSW-CPS"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## CPS trimmed</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.nsw_cps.trim</span>, <span class="va">qte.nsw_cps.trim0</span>, <span class="va">qte.nsw.cps</span>, main <span class="op">=</span> <span class="st">"NSW-CPS (Trimmed)"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PSID</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.nsw_psid</span>, <span class="va">qte.nsw_psid0</span>, <span class="va">qte.nsw</span>, main <span class="op">=</span> <span class="st">"NSW-PSID"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PSID trimmed</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.nsw_psid.trim</span>, <span class="va">qte.nsw_psid.trim0</span>, <span class="va">qte.nsw.psid</span>, main <span class="op">=</span> <span class="st">"NSW-PSID (Trimmed)"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-46-1.png" alt="FIGURE A7. Quantile Treatment Effects: Experimental vs. Nonexperimental" width="100%"><p class="caption">
Figure 3.5: FIGURE A7. Quantile Treatment Effects: Experimental vs. Nonexperimental
</p>
</div>
<p>Note: Figures show QTET using both experimental data (in blue) and nonexperimental data (in red for raw estimates and black for covariate-adjusted estimates). Each dot corresponds to a QTET estimate at a particular quantile, while shaded areas represent bootstrapped 95% confidence intervals. Unadjusted models do not incorporate covariates while adjustment models use the full set of covariates to estimate the propensity scores with a logit.</p>
</div>
</div>
<div id="sensitivity-analyses-1" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Sensitivity Analyses<a class="anchor" aria-label="anchor" href="#sensitivity-analyses-1"><i class="fas fa-link"></i></a>
</h2>
<p>Below are our sensitivity analyses using the original LaLonde male sample, with results depicted in contour plots below.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## datasets to be used: nsw, nsw_trim_cps, nsw_trim_psid</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"re78"</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"black"</span>, <span class="st">"hispanic"</span>, <span class="st">"married"</span>, <span class="st">"nodegree"</span>, <span class="st">"re75"</span>, <span class="st">"u75"</span><span class="op">)</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"re75"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># trimmed NSW-CPS data</span></span>
<span><span class="fu">sens_ana</span><span class="op">(</span><span class="va">nsw_trim_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, <span class="va">bm</span>, kd <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># trimmed NSW-PSID data</span></span>
<span><span class="fu">sens_ana</span><span class="op">(</span><span class="va">nsw_trim_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, <span class="va">bm</span>, kd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-47"></span>
<img src="tutorial0601_files/figure-html/unnamed-chunk-47-1.png" alt="FIGURE A3. Sensitivity Analyses for Trimmed NSW-CPS1 and NSW-PSID1" width="100%"><p class="caption">
Figure 3.6: FIGURE A3. Sensitivity Analyses for Trimmed NSW-CPS1 and NSW-PSID1
</p>
</div>
<p>The analyses suggest that the estimated training effect based on trimmed NSW-CPS is less sensitive to potential confounders compared to trimmed NSW-PSID.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lalonde-dehejia-wahba-ldw-data.html"><span class="header-section-number">2</span> LaLonde-Dehejia-Wahba (LDW) Data</a></div>
<div class="next"><a href="the-lottery-data.html"><span class="header-section-number">4</span> The Lottery Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#original-lalonde-data-male-sample"><span class="header-section-number">3</span> Original LaLonde Data (Male Sample)</a></li>
<li><a class="nav-link" href="#prepare-the-data"><span class="header-section-number">3.1</span> Prepare the Data</a></li>
<li>
<a class="nav-link" href="#assessing-overlap-1"><span class="header-section-number">3.2</span> Assessing Overlap</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#nsw-experimental"><span class="header-section-number">3.2.1</span> NSW-Experimental</a></li>
<li><a class="nav-link" href="#nsw-cps1-and-nsw-psid1"><span class="header-section-number">3.2.2</span> NSW-CPS1 and NSW-PSID1</a></li>
</ul>
</li>
<li><a class="nav-link" href="#trimming-to-improve-overlap-1"><span class="header-section-number">3.3</span> Trimming to Improve Overlap</a></li>
<li><a class="nav-link" href="#reassessing-overlap-1"><span class="header-section-number">3.4</span> Reassessing Overlap</a></li>
<li><a class="nav-link" href="#estimating-the-att-1"><span class="header-section-number">3.5</span> Estimating the ATT</a></li>
<li>
<a class="nav-link" href="#alternative-estimands-catt-and-qtet-1"><span class="header-section-number">3.6</span> Alternative Estimands: CATT and QTET</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conditional-average-treatment-effect-on-the-treated-catt-1"><span class="header-section-number">3.6.1</span> Conditional Average Treatment Effect on the Treated (CATT)</a></li>
<li><a class="nav-link" href="#quantile-treatment-effect-on-the-treated-qtet-1"><span class="header-section-number">3.6.2</span> Quantile Treatment Effect on the Treated (QTET)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sensitivity-analyses-1"><span class="header-section-number">3.7</span> Sensitivity Analyses</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/xuyiqing/lalonde/blob/main/tutorial/03-NSW.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/xuyiqing/lalonde/edit/main/tutorial/03-NSW.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tutorial and Code for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’</strong>" was written by Guido Imbens, Yiqing Xu. It was last built on 2024-06-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
