"0","est_qte <- function(Y, treat, covar, data, ps = TRUE,"
"0","                    probs = seq(0.05,0.95,0.05), cores = 20,"
"0","                    ylim = NULL) {"
"0","  # Set up"
"0","  if (is.null(covar)) {"
"0","    formla <- as.formula(paste(Y, ""~"", treat))"
"0","  } else {"
"0","    formla <- as.formula(paste(Y, ""~"", treat, ""+"", paste(covar, collapse = ""+"")))"
"0","  }"
"0","  if (is.null(covar) | ps == FALSE) {"
"0","    mod <- ci.qtet(formla, xformla = NULL, data = data,"
"0","                   probs = probs, se = TRUE, iters = 1000, pl = TRUE, cores = cores)"
"0","  } else {"
"0","    xformla <- as.formula(paste(""~"", paste(covar, collapse = ""+"")))"
"0","    mod <- ci.qtet(formla, xformla = xformla, data = data,"
"0","                   probs = probs, se = TRUE, iters = 1000, pl = TRUE, cores = cores)"
"0","  }"
"0","  return(mod)"
"0","}"
"0",""
"0",""
